<!doctype html>
<html lang="de">
<head>
    <title>Hamburg Geschichte</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../index.css">
    <style>
        #container {
            width: 100vw;
            height: 100vh;
            padding: 20px;
        }

    </style>
</head>
<body>
<noscript><strong>Please enable JavaScript to view this page correctly.</strong></noscript>
<header>

</header>
<main>

    <div class="large centered row" style="width: 300px;">
        <svg class="logo js" preserveAspectRatio="xMidYMid meet" viewBox="0 0 630 630"><path fill="currentColor" d="M577,0 C606.271092,0 630,23.7289083 630,53 L630,577 C630,606.271092 606.271092,630 577,630 L53,630 C23.7289083,630 0,606.271092 0,577 L0,53 C0,23.7289083 23.7289083,0 53,0 L577,0 Z M479.5,285.89 C426.63,285.89 392.8,319.69 392.8,364.09 C392.8,411.808 420.615238,434.63146 462.622716,452.742599 L478.7,459.64 L483.441157,461.719734 C507.57404,472.359996 521.8,479.858 521.8,498.94 C521.8,515.88 506.13,528.14 481.6,528.14 C452.4,528.14 435.89,512.91 423.2,492.19 L375.09,520.14 C392.47,554.48 427.99,580.68 482.97,580.68 C539.2,580.68 581.07,551.48 581.07,498.18 C581.07,448.74 552.67,426.75 502.37,405.18 L487.57,398.84 L485.322788,397.859899 C461.5199,387.399087 451.17,380.1172 451.17,362.89 C451.17,348.52 462.16,337.52 479.5,337.52 C496.5,337.52 507.45,344.69 517.6,362.89 L563.7,333.29 C544.2,298.99 517.14,285.89 479.5,285.89 Z M343.09,289.27 L283.89,289.27 L283.89,490.57 C283.89,520.16 271.62,527.77 252.17,527.77 C231.83,527.77 223.37,513.82 214.07,497.32 L165.88,526.495 C179.84,556.04 207.29,580.57 254.69,580.57 C307.15,580.57 343.09,552.67 343.09,491.37 L343.09,289.27 Z"/></svg>
    </div>
    <div class="medium row">
        <fieldset class="controls">
            <button>rotations: 0</button>
        </fieldset>
    </div>

    <button id="tlanim">Animate</button>
    <div id="container">
        <svg id="mainSvg" width="100%" height="100%" viewbox="0 0 1496 812">
            <!-- Hintergrundbereiche -->
            <rect x="0" y="0" width="1496" height="270" fill="#ADE0D1" />
            <rect x="0" y="270" width="1496" height="542" fill="#F9DB90" />

            <!-- ClipPath für die Timeline -->
            <defs>
                <clipPath id="timelineClip">
                    <rect x="0" y="0" width="1496" height="270"/>
                </clipPath>
                <clipPath id="mapClip">
                    <rect x="0" y="270" width="1496" height="542"/>
                </clipPath>
            </defs>

            <!-- Gruppe mit Timeline und Bildern (bewegbar) -->
            <g>

                <!-- Timeline-Gruppe -->
                <svg id="timelineSvg" x="0" y="0" width="1496" height="270" viewBox="0 0 1496 270">
                    <!-- Timeline wird per JavaScript eingefügt -->
                </svg>

                <!-- Bildbereich -->
                <svg id="mapSvg" x="0" y="270" width="1496" height="542" viewBox="0 0 1496 542">

                    <def>
                        <path id="start2" d="M265.621,433.305L583.194,271L726.397,21.254L886.287,242.899L1153.1,474.535L807.254,433.305L622.119,409.408L265.621,433.305Z"/>
                    </def>

                    <g stroke-width="2" stroke="currentColor" stroke-linejoin="round" fill="none" fill-rule="evenodd">
                        <polygon id="path-1" points="152,4 170,38 204,56 170,74 152,108 134,74 100,56 134,38"></polygon>
                        <polygon style="opacity: 0" id="path-2" points="152,4 170,38 204,56 170,74 152,108 134,74 100,56 134,38"></polygon>
                    </g>

                    <path id="start" d="M357.088,298.528L583.194,271L726.032,112.373L886.287,242.899L1017.54,271L807.254,433.305L622.119,409.408L357.088,298.528Z"/>

                    <!--
                    <path id="target" d="M301.136,296.784L487.226,271L529.476,302.842L667.166,90.481L848.299,130.767L906.366,216.205L1090.1,271L940.809,380.942L936.633,515.569L687.312,518.372L674.817,471.662L437.036,433.305L301.136,296.784Z" style="stroke:black;stroke-width:1px;"/>
                    -->

                    <!-- Platzhalterbilder -->
                    <!-- In deinem Projekt bitte durch tatsächliche URLs ersetzen -->
                    <!--
                    <image href="maps/1070.jpg" x="0" y="30" width="600" />
                    <image href="maps/1200.jpg" x="700" y="30" width="600" />
                    <image href="maps/1300.jpg" x="1400" y="30" width="600" />
                    <image href="maps/1400.jpg" x="2100" y="30" width="600" />
                    <image href="maps/1550.jpg" x="2800" y="30" width="600" />
                    <image href="maps/1630.jpg" x="3500" y="30" width="600" />
                    <image href="maps/1722.jpg" x="4200" y="30" width="600" />
                    <image href="maps/1830.jpg" x="4900" y="30" width="600" />
                    <image href="maps/1880.jpg" x="5600" y="30" width="600" />
                    <image href="maps/1911.jpg" x="6300" y="30" width="600" />
                    -->
                </svg>
            </g>
        </svg>


    </div>

</main>
<footer>

</footer>
<script type="module" src="../../index.js"></script>

<script>
    const svg = document.getElementById('timelineSvg');

    const startYear = 1200;
    const endYear = 2000;
    const centuryWidth = 1000;
    const decadeWidth = centuryWidth / 10;
    const startX = 200;

    const largeHeight = 90;
    const smallHeight = 70;
    const barWidth = 7;

    const colorDark = '#B69131';
    const colorLight = '#DDC37E';

    for (let year = startYear; year <= endYear; year += 10) {
        const position = startX + ((year - startYear) / 10) * decadeWidth;
        const isCentury = year % 100 === 0;
        const isHalfCentury = year % 100 === 50;

        const height = isCentury ? largeHeight : smallHeight;
        const fill = (isCentury || isHalfCentury) ? colorDark : colorLight;
        const yPos = isCentury ? 100 : 110;

        // Balken zeichnen
        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
        rect.setAttribute('x', position - barWidth / 2);
        rect.setAttribute('y', yPos);
        rect.setAttribute('width', barWidth);
        rect.setAttribute('height', height);
        rect.setAttribute('fill', fill);
        svg.appendChild(rect);

        // Text nur bei vollen Jahrhunderten
        if (isCentury) {
            const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            text.setAttribute('x', position);
            text.setAttribute('y', 80);
            text.setAttribute('text-anchor', 'middle');
            text.setAttribute('fill', '#5E564B');
            text.setAttribute('font-size', '40');
            text.setAttribute('font-family', 'Montserrat Thin');
            text.textContent = year;
            svg.appendChild(text);
        }
    }
</script>

<script type="module">
    import { animate, utils, createDraggable, createSpring } from '../../lib/anime.esm.min.js';

    const [ $logo ] = utils.$('.logo.js');
    const [ $button ] = utils.$('button');
    let rotations = 0;

    // Created a bounce animation loop
    animate('.logo.js', {
        scale: [
            { to: 1.25, ease: 'inOut(3)', duration: 200 },
            { to: 1, ease: createSpring({ stiffness: 300 }) }
        ],
        loop: true,
        loopDelay: 250,
    });

    // Make the logo draggable around its center
    createDraggable('.logo.js', {
        container: [0, 0, 0, 0],
        releaseEase: createSpring({ stiffness: 200 })
    });

    // Animate logo rotation on click
    const rotateLogo = () => {
        rotations++;
        $button.innerText = `rotations: ${rotations}`;
        animate($logo, {
            rotate: rotations * 360,
            ease: 'out(4)',
            duration: 1500,
        });
    }

    $button.addEventListener('click', rotateLogo);

</script>


<script type="module">
    import { animate } from '../../lib/anime.esm.min.js'; // Oder passe deinen Pfad korrekt an, wenn du lokal arbeitest!

    document.querySelector('button#tlanim').addEventListener('click', () => {
        const svgTL = document.getElementById('timelineSvg');

        const animation = animate(svg, {
            // Wir benutzen KEIN freies Objekt mehr, sondern das echte SVG als Target
            // Eigenschaft: translateX oder eine eigene Animation selbst bauen
            // Wir nutzen stattdessen ein Dummy-Property über CSS-Variablen!

            // Da wir viewBox nicht direkt animieren können, brauchen wir einen Workaround
            // Wir erstellen eine CSS-Variable am SVG
            '--x': [0, 6300],
            duration: 10000,
            easing: 'linear',
            onUpdate: (anim) => {
                // Holen uns den aktuellen Wert der CSS-Variable
                const x = parseFloat(getComputedStyle(svgTL).getPropertyValue('--x'));
                svgTL.setAttribute('viewBox', `${x} 0 1496 270`);
            }
        });
    });
</script>

<script type="module">
    import { animate, svg, utils } from '../../lib/anime.esm.min.js';


    const pathStart = document.getElementById('start');
    const pathStart2 = document.getElementById('start2');
    const pathTarget = document.getElementById('target');

    animate(pathStart, {
        d: svg.morphTo(pathStart2),
        ease: 'inOutCirc',
        duration: 500
    });

    const [ $path1, $path2 ] = utils.$('polygon');

    function animateRandomPoints() {
        // Update the points attribute on #path-2
        utils.set($path2, { points: generatePoints() });
        // Morph the points of #path-1 into #path-2
        animate($path1, {
            points: svg.morphTo($path2),
            ease: 'inOutCirc',
            duration: 500,
            onComplete: animateRandomPoints
        });
    }

    // Start the animation
    animateRandomPoints();

    // A function to generate random points on #path-2 on each iteration
    // For demo purpose only
    function generatePoints() {
        const total = utils.random(4, 64);
        const r1 = utils.random(4, 56);
        const r2 = 56;
        const isOdd = n => n % 2;
        let points = '';
        for (let i = 0, l = isOdd(total) ? total + 1 : total; i < l; i++) {
            const r = isOdd(i) ? r1 : r2;
            const a = (2 * Math.PI * i / l) - Math.PI / 2;
            const x = 152 + utils.round(r * Math.cos(a), 0);
            const y = 56 + utils.round(r * Math.sin(a), 0);
            points += `${x},${y} `;
        }
        return points;
    }

</script>



</body>
</html>
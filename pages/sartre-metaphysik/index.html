<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Sartre SVG Inhaltsverzeichnis</title>
  <style>
    body {
      background: #e8e2d0;
      padding: 2rem;
      font-family: system-ui, sans-serif;
    }
  </style>
</head>
<body>
  <svg id="toc" width="600" height="1800"></svg>

  <script>
    const data = [
      {
        "title": "Einleitung: Auf der Suche nach dem Sein",
        "chapters": [
          { "title": "I. Die Idee des Phänomens" },
          { "title": "II. Das Seinsphänomen und das Sein des Phänomens" },
          { "title": "III. Das *präreflexive* Cogito und das Sein des *percipere*" }
        ]
      },
      {
        "title": "Erster Teil: Das Problem des Nichts",
        "chapters": [
          {
            "title": "Erstes Kapitel: Der Ursprung der Negation",
            "sections": [
              "I. Die Frage",
              "II. Die Negationen",
              "III. Das Nichts",
              "IV. Das Sein des Menschen und das Nichts",
              "V. Die Negation und die Freiheit"
            ]
          },
          {
            "title": "Zweites Kapitel: Die Unaufrichtigkeit",
            "sections": [
              "I. Unaufrichtigkeit und Lüge",
              "II. Die Verhaltensweisen der Unaufrichtigkeit"
            ]
          }
        ]
      }
    ];

    const svg = document.getElementById("toc");
    const width = svg.clientWidth;
    const padding = 24;
    const blockHeight = 140;
    const blockMargin = 40;
    const indent = 28;
    let currentY = svg.clientHeight - padding;

    const createText = (text, x, y, bold = false) => {
      const el = document.createElementNS("http://www.w3.org/2000/svg", "text");
      el.setAttribute("x", x);
      el.setAttribute("y", y);
      el.setAttribute("font-size", "14");
      el.setAttribute("fill", "#222");
      el.setAttribute("text-anchor", "start");
      el.setAttribute("dominant-baseline", "text-after-edge");
      if (bold) el.setAttribute("font-weight", "bold");
      el.innerHTML = text;
      return el;
    };

    const createRect = (x, y, w, h, fill = "#fefdfb") => {
      const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
      rect.setAttribute("x", x);
      rect.setAttribute("y", y);
      rect.setAttribute("width", w);
      rect.setAttribute("height", h);
      rect.setAttribute("fill", fill);
      rect.setAttribute("stroke", "#eee");
      return rect;
    };

    const drawEntryBlock = (entries, label, level = 1) => {
      const group = document.createElementNS("http://www.w3.org/2000/svg", "g");
      const blockX = indent * level;
      const blockW = width - blockX - padding;

      entries.forEach((text, i) => {
        const y = currentY - blockHeight;
        group.appendChild(createRect(blockX, y, blockW, blockHeight - 4));
        group.appendChild(createText(text, blockX + padding, y + blockHeight - 16));
        currentY -= blockHeight;
      });

      // Titel des Blocks
      currentY -= 10;
      svg.appendChild(group);
      svg.appendChild(createText(label, padding * level, currentY, true));
      currentY -= blockMargin;
    };

    // Von unten nach oben: erste Section zuerst
    data.forEach(section => {
      if (section.chapters) {
        section.chapters.forEach(chapter => {
          if (chapter.sections) {
            drawEntryBlock(chapter.sections.slice().reverse(), chapter.title, 2);
          } else {
            drawEntryBlock([chapter.title], "", 1);
          }
        });
      }
      svg.appendChild(createText(section.title, padding, currentY, true));
      currentY -= blockMargin;
    });
  </script>
</body>
</html>

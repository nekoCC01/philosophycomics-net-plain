<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    TEST 123
    <svg id="meinSVG" width="750" height="1200" style="border:1px solid gray;"></svg>

    <script>
        /*
        const svg = document.getElementById("meinSVG");
    
        // Gruppe erstellen
        const group = document.createElementNS("http://www.w3.org/2000/svg", "g");
    
        // Drei Rechtecke mit relativer Position
        const rect1 = document.createElementNS("http://www.w3.org/2000/svg", "rect");
        rect1.setAttribute("x", 50);
        rect1.setAttribute("y", 0); // ganz unten in der Gruppe
        rect1.setAttribute("width", 200);
        rect1.setAttribute("height", 100);
        rect1.setAttribute("fill", "lightblue");
    
        const rect2 = document.createElementNS("http://www.w3.org/2000/svg", "rect");
        rect2.setAttribute("x", 50);
        rect2.setAttribute("y", -150); // 50px höher
        rect2.setAttribute("width", 200);
        rect2.setAttribute("height", 100);
        rect2.setAttribute("fill", "lightgreen");
    
        const rect3 = document.createElementNS("http://www.w3.org/2000/svg", "rect");
        rect3.setAttribute("x", 50);
        rect3.setAttribute("y", -300); // 100px höher als rect1
        rect3.setAttribute("width", 200);
        rect3.setAttribute("height", 100);
        rect3.setAttribute("fill", "lightcoral");
    
        // Rechtecke zur Gruppe hinzufügen
        group.appendChild(rect1);
        group.appendChild(rect2);
        group.appendChild(rect3);
    
        // Ganze Gruppe auf y=500 verschieben
        group.setAttribute("transform", "translate(0, 500)");
    
        // Gruppe zum SVG hinzufügen
        svg.appendChild(group);
        */
    </script>

    <script>
        const data =
        {
            "title": "Das Sein und das Nichts",
            "chapters": [

                {
                    "title": "Einleitung: Auf der Suche nach dem Sein",
                    "chapters": [
                        {
                            "title": "--",
                            "chapters": [
                                { "title": "I. Die Idee des Phänomens", "height": 5 },
                                { "title": "II. Das Seinsphänomen und das Sein des Phänomens", "height": 5 },
                                { "title": "III. Das *präreflexive* Cogito und das Sein des *percipere*", "height": 5 }
                            ]
                        }
                    ]
                },
                {
                    "title": "Erster Teil: Das Problem des Nichts",
                    "chapters": [
                        {
                            "title": "Erstes Kapitel: Der Ursprung der Negation",
                            "chapters": [
                                { "title": "I. Die Frage", "height": 5 },
                                { "title": "II. Die Negationen", "height": 3 },
                                { "title": "III. Das Nichts", "height": 1 },
                                { "title": "IV. Das Sein des Menschen und das Nichts", "height": 6 },
                                { "title": "V. Die Negation und die Freiheit", "height": 2 }
                            ]
                        },

                        {
                            "title": "Zweites Kapitel: Die Unaufrichtigkeit",
                            "chapters": [
                                { "title": "I. Unaufrichtigkeit und Lüge", "height": 5 },
                                { "title": "II. Die Verhaltensweisen der Unaufrichtigkeit", "height": 5 }
                            ]
                        }
                    ]
                }
            ]
        };



        let svg = document.getElementById("meinSVG");
        /*
        data.forEach(part => {
            // title
            console.log(part.title);
            let rect = createRect(25, 25, 700, 50, "lightblue");
            //svg.appendChild(rect);

            let height = 0;

            let text = createText(30, 50, part.title);
            //svg.appendChild(text);

            // chapters
            part.chapters.forEach(chapter => {
                // chapter title
                console.log("  " + chapter.title);
                let chapterRect = createRect(50, 900, 600, 40, "lightgreen");
                let group = document.createElementNS("http://www.w3.org/2000/svg", "g");

                // chapter sections
                let y = 800;
                let totalHeight = 0;
                chapter.sections.forEach(section => {
                    // section title
                    console.log("    " + section.title);
                    let height = 20 * section.height;
                    // Adjust height based on section height
                    let sectionRect = createRect(100, y - height, 500, height, "lightcoral");

                    y = y - height - 20;
                    totalHeight += height + 20;
                    group.appendChild(sectionRect);
                });
                chapterRect.setAttribute("height", totalHeight + 40);
                chapterRect.setAttribute("y", 800 - totalHeight);
                chapterRect.id = "chapterRect";
                svg.appendChild(chapterRect);
                svg.appendChild(group);
            });
        });
        */

        function createRect(x, y, width, height, fill) {
            const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            rect.setAttribute("x", x);
            rect.setAttribute("y", y);
            rect.setAttribute("width", width);
            rect.setAttribute("height", height);
            rect.setAttribute("fill", fill);
            return rect;
        }
        function createText(x, y, textContent) {
            const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text.setAttribute("x", x);
            text.setAttribute("y", y);
            text.setAttribute("font-size", "14");
            text.setAttribute("fill", "#222");
            text.textContent = textContent;
            return text;
        }



        function createContainerWithChildren(container) {

            let containerRect = createRect(25, 25, 700, 50, "lightblue");
            // 
            let totalHeight = 0;
            container.chapters.forEach(child => {
                //
                if (child.chapters) {
                    child = createContainerWithChildren(child);
                }
                // create a rectangle for each child
                // track height
                let childHeight = getHeight(child);
                let childRect = createRect(50, 900, 500, childHeight, "lightgreen");
                totalHeight += childHeight + 40; // adjust height based on child height
            });

            containerRect.setAttribute("height", totalHeight);
            return containerRect;


        }

        function getHeight(child) {
            let childHeight = 0;
            if (child instanceof SVGRectElement) {
                childHeight = child.height.baseVal.value;
            }
            else {
                childHeight = child.height;
            }
            return childHeight;
        }


        let container = createContainerWithChildren(data);

    </script>
</body>

</html>